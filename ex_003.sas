LIBNAME mydata "/courses/d1406ae5ba27fe300 " access=readonly;
DATA new; set mydata.addhealth_pds;

IF H1GI4 GE 6 then H1GI4=.;
IF H1GI6A GE 6 then H1GI6A=.;
IF H1GI6B GE 6 then H1GI6B=.;
IF H1GI6C GE 6 then H1GI6C=.;
IF H1GI6D GE 6 then H1GI6D=.;

NUMETHNIC = SUM (of H1GI4 H1GI6A H1GI6B H1GI6C H1GI6D);

IF NUMETHNIC GE 2 THEN ETHNICITY=1; /*Multi race*/
ELSE IF H1GI4=1 THEN ETHNICITY=2; /*Latino*/
ELSE IF H1GI6A=1 THEN ETHNICITY=6; /*Black*/
ELSE IF H1GI6B=1 THEN ETHNICITY=3; /*Indian*/
ELSE IF H1GI6C=1 THEN ETHNICITY=4; /*Asian*/
ELSE IF H1GI6D=1 THEN ETHNICITY=5; /*White*/

PROC SORT; by AID;
PROC PRINT; VAR H1GI4 H1GI6B H1GI6C H1GI6D H1GI6A NUMETHNIC ETHNICITY; 
PROC FREQ; TABLES H1GI4 H1GI6B H1GI6C H1GI6D H1GI6A NUMETHNIC ETHNICITY;
RUN;
